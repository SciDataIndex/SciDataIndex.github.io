<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SciDataIndex Â· æ•°æ®åˆ—è¡¨</title>
  <style>
    @import url("https://fonts.googleapis.com/css2?family=Sora:wght@300;400;600;700&display=swap");

    :root {
      --bg-0: #02061a;
      --bg-1: #061338;
      --bg-2: #0a1f4f;
      --accent: #2ee6c9;
      --glow: #6bdcff;
      --text-0: #e9f2ff;
      --text-1: #b6c7e6;
      --card: rgba(12, 27, 69, 0.7);
      --stroke: rgba(255, 255, 255, 0.18);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: "Sora", "HarmonyOS Sans SC", "PingFang SC", sans-serif;
      color: var(--text-0);
      background: radial-gradient(900px 450px at 20% 20%, #183ea4 0%, transparent 60%),
        radial-gradient(900px 520px at 80% 20%, #0c1a45 0%, transparent 70%),
        linear-gradient(180deg, var(--bg-2) 0%, var(--bg-1) 50%, var(--bg-0) 100%);
      min-height: 100vh;
    }

    .nav {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px 48px;
      background: rgba(3, 9, 32, 0.7);
      backdrop-filter: blur(8px);
    }

    .nav-left {
      display: flex;
      align-items: center;
      gap: 24px;
    }

    .nav-links {
      display: flex;
      gap: 18px;
      color: var(--text-1);
      font-size: 14px;
    }

    .nav-links a {
      color: inherit;
      text-decoration: none;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
      font-weight: 700;
      font-size: 20px;
      color: var(--glow);
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 40px 24px 80px;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
      gap: 20px;
      flex-wrap: wrap;
      margin-bottom: 28px;
    }

    .title-block h1 {
      margin: 0 0 8px;
      font-size: clamp(28px, 4vw, 40px);
    }

    .title-block p {
      margin: 0;
      color: var(--text-1);
      font-size: 15px;
    }

    .search-bar {
      display: flex;
      align-items: center;
      gap: 10px;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      padding: 8px 14px;
      border-radius: 999px;
      min-width: 260px;
    }

    .search-bar input {
      background: transparent;
      border: none;
      outline: none;
      color: var(--text-0);
      width: 100%;
      font-size: 13px;
    }

    .search-bar input::placeholder {
      color: rgba(255, 255, 255, 0.6);
    }

    .board {
      border: 1px solid var(--stroke);
      border-radius: 18px;
      overflow: hidden;
      background: var(--card);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.35);
    }

    .board-head,
    .board-row {
      display: grid;
      grid-template-columns: 80px 1.6fr 220px;
      gap: 12px;
      padding: 16px 20px;
      align-items: center;
    }

    .board-head {
      background: rgba(12, 22, 56, 0.9);
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: #8ea5d7;
    }

    .board-row {
      border-top: 1px solid rgba(255, 255, 255, 0.06);
      font-size: 15px;
    }

    .board-row:first-child {
      border-top: none;
    }

    .rank {
      font-size: 20px;
      font-weight: 700;
      color: var(--accent);
    }

    .dataset-name {
      font-weight: 600;
      color: var(--text-0);
      text-decoration: none;
    }

    .category-tag {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.12);
      border: 1px solid rgba(255, 255, 255, 0.18);
      color: var(--text-0);
      font-size: 12px;
      justify-self: start;
    }

    .pagination {
      margin-top: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
    }

    .page-btn {
      padding: 8px 16px;
      border-radius: 999px;
      border: 1px solid var(--stroke);
      background: rgba(255, 255, 255, 0.1);
      color: var(--text-0);
      cursor: pointer;
      font-size: 13px;
    }

    .page-btn:disabled {
      opacity: 0.45;
      cursor: not-allowed;
    }

    .page-info {
      font-size: 13px;
      color: var(--text-1);
    }

    .page-input {
      width: 80px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--stroke);
      background: rgba(255, 255, 255, 0.08);
      color: var(--text-0);
      font-size: 13px;
      text-align: center;
    }

    .page-input::placeholder {
      color: rgba(255, 255, 255, 0.6);
    }

    .page-input.inline {
      width: auto;
      min-width: 2ch;
      max-width: 4ch;
      padding: 2px 6px;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.12);
    }

    .page-input.inline::-webkit-outer-spin-button,
    .page-input.inline::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }

    .page-input.inline[type="number"] {
      -moz-appearance: textfield;
      appearance: textfield;
    }

    .disclaimer {
      margin-top: 24px;
      padding: 14px 18px;
      border-radius: 14px;
      border: 1px solid var(--stroke);
      background: rgba(255, 255, 255, 0.06);
      color: var(--text-1);
      font-size: 12px;
      line-height: 1.7;
    }

    .disclaimer p {
      margin: 0 0 6px;
    }

    .disclaimer p:last-child {
      margin-bottom: 0;
    }

    @media (max-width: 980px) {
      .board-head,
      .board-row {
        grid-template-columns: 60px 1fr;
      }

      .board-head div:last-child,
      .board-row div:last-child {
        display: none;
      }
    }
  </style>
</head>
<body>
  <header class="nav">
    <div class="nav-left">
      <div class="brand">SciDataIndex</div>
      <nav class="nav-links">
        <a href="index.html">é¦–é¡µ</a>
        <a href="data_ranks/earth_science.html">æ•°æ®æ¦œå•</a>
        <a href="evaluation.html">æŠ€æœ¯è¯´æ˜</a>
        <a href="about.html">å…³äºæˆ‘ä»¬</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <div class="header">
      <div class="title-block">
        <h1>æ•°æ®åˆ—è¡¨</h1>
        <p>æŒ‰å­¦ç§‘æ±‡æ€»æ‰€æœ‰æ•°æ®é›†ï¼Œä»…æ˜¾ç¤ºåç§°ä¸å­¦ç§‘åˆ†ç±»</p>
      </div>
      <label class="search-bar">
        <span>ğŸ”</span>
        <input id="searchInput" type="search" placeholder="æœç´¢æ•°æ®é›†åç§°..." />
      </label>
    </div>

    <section class="board">
      <div class="board-head">
        <div>åºå·</div>
        <div>æ•°æ®é›†</div>
        <div>å­¦ç§‘åˆ†ç±»</div>
      </div>
      <div id="boardRows"></div>
    </section>
    <div class="pagination">
      <button class="page-btn" id="firstPage">é¦–é¡µ</button>
      <button class="page-btn" id="prevPage">ä¸Šä¸€é¡µ</button>
      <span class="page-info">
        ç¬¬
        <input class="page-input inline" id="pageInput" type="number" min="1" />
        / <span id="pageTotal">1</span> é¡µ
      </span>
      <button class="page-btn" id="nextPage">ä¸‹ä¸€é¡µ</button>
      <button class="page-btn" id="lastPage">å°¾é¡µ</button>
    </div>

    <div class="disclaimer">
      <p>æœ¬æ¦œå•æ¶‰åŠç§‘å­¦æ•°æ®ä¿¡æ¯å‡æ¥è‡ªäº’è”ç½‘æœç´¢æ™ºèƒ½ä½“æŒ–æ˜ä¿¡æ¯ï¼Œæœ¬æ¦œå•ä¸å¯¹æ•°æ®ä¿¡æ¯å‡†ç¡®æ€§è´Ÿè´£ã€‚</p>
      <p>æœ¬æ¦œå•è¯„åˆ†è§„åˆ™ç”±ä¸Šæµ·äººå·¥æ™ºèƒ½å®éªŒå®¤AI4Scicenceä¸­å¿ƒç»„ç»‡åˆ¶å®šï¼Œè¯„åˆ†ç»“è®ºä»…ä¾›å‚è€ƒã€‚</p>
      <p>æœ¬æ¦œå•æ‰€æ¶‰åŠçš„ç§‘å­¦æ•°æ®èŒƒå›´å’Œç‰ˆæœ¬å°†æŒç»­æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨åç»­ç‰ˆæœ¬ã€‚</p>
    </div>
  </main>

  <script>
    const SUBJECTS = [
      { label: "åœ°çƒç§‘å­¦", key: "earth_science" },
      { label: "ç”Ÿå‘½ç§‘å­¦", key: "life_science" },
      { label: "ç‰©è´¨ç§‘å­¦", key: "physical_science" },
      { label: "ç¥ç»ç§‘å­¦", key: "neuro_science" },
      { label: "åŒ–å­¦ç§‘å­¦", key: "chemistry_science" },
      { label: "ææ–™ç§‘å­¦", key: "material_science" },
      { label: "å¤©æ–‡ç§‘å­¦", key: "astronomy_science" },
      { label: "é€šè¯†ç§‘å­¦", key: "general_science" },
    ];

    const rows = document.getElementById("boardRows");
    const searchInput = document.getElementById("searchInput");
    const firstPageBtn = document.getElementById("firstPage");
    const prevPageBtn = document.getElementById("prevPage");
    const nextPageBtn = document.getElementById("nextPage");
    const lastPageBtn = document.getElementById("lastPage");
    const pageInput = document.getElementById("pageInput");
    const pageTotal = document.getElementById("pageTotal");
    const pageSize = 15;
    let currentPage = 1;
    let allRows = [];
    let filteredRows = [];

    async function tryFetchJson(url) {
      try {
        const res = await fetch(url);
        if (!res.ok) return null;
        return await res.json();
      } catch (err) {
        return null;
      }
    }

    async function fetchJsonWithFallback(base, fileName) {
      const raw = await tryFetchJson(`${base}${fileName}`);
      if (raw) return raw;
      return await tryFetchJson(`${base}${encodeURIComponent(fileName)}`);
    }

    async function loadIndex(category) {
      const res = await fetch(`data_json/${category}/dataset_index.json`);
      if (!res.ok) return [];
      const list = await res.json();
      return Array.isArray(list) ? list : [];
    }

    async function loadDataset(category, fileName) {
      const data = await fetchJsonWithFallback(`data_json/${category}/`, fileName);
      if (!data) return null;
      return data.dataset || fileName;
    }

    function renderPage() {
      rows.innerHTML = "";
      const totalPages = Math.max(1, Math.ceil(filteredRows.length / pageSize));
      currentPage = Math.min(currentPage, totalPages);
      const start = (currentPage - 1) * pageSize;
      const items = filteredRows.slice(start, start + pageSize);
      items.forEach((item, idx) => {
        const row = document.createElement("div");
        row.className = "board-row";
        row.innerHTML = `
          <div class="rank">${String(start + idx + 1).padStart(2, "0")}</div>
          <div>
            <a class="dataset-name" href="dataset_detail.html?name=${encodeURIComponent(item.name)}&file=${encodeURIComponent(item.fileName)}&category=${item.categoryKey}">${item.name}</a>
          </div>
          <div class="category-tag">${item.categoryLabel}</div>
        `;
        rows.appendChild(row);
      });
      prevPageBtn.disabled = currentPage <= 1;
      nextPageBtn.disabled = currentPage >= totalPages;
      firstPageBtn.disabled = currentPage <= 1;
      lastPageBtn.disabled = currentPage >= totalPages;
      pageInput.value = String(currentPage);
      pageTotal.textContent = String(totalPages);
    }

    function applySearch() {
      const query = searchInput.value.trim().toLowerCase();
      filteredRows = query
        ? allRows.filter(item => item.name.toLowerCase().includes(query))
        : [...allRows];
      currentPage = 1;
      renderPage();
    }

    async function renderList() {
      rows.innerHTML = "";
      let index = 1;
      allRows = [];
      for (const subject of SUBJECTS) {
        const files = await loadIndex(subject.key);
        const names = (await Promise.all(files.map(file => loadDataset(subject.key, file)))).filter(Boolean);
        for (const name of names) {
          const fileName = `${name.replace(/\s+/g, "_").replace(/[\\/]/g, "_")}_ratings1.json`;
          allRows.push({
            name,
            fileName,
            categoryKey: subject.key,
            categoryLabel: subject.label,
            index
          });
          index += 1;
        }
      }
      filteredRows = [...allRows];
      renderPage();
    }

    searchInput.addEventListener("input", applySearch);

    prevPageBtn.addEventListener("click", () => {
      if (currentPage > 1) {
        currentPage -= 1;
        renderPage();
      }
    });

    nextPageBtn.addEventListener("click", () => {
      const totalPages = Math.max(1, Math.ceil(filteredRows.length / pageSize));
      if (currentPage < totalPages) {
        currentPage += 1;
        renderPage();
      }
    });

    firstPageBtn.addEventListener("click", () => {
      currentPage = 1;
      renderPage();
    });

    lastPageBtn.addEventListener("click", () => {
      const totalPages = Math.max(1, Math.ceil(filteredRows.length / pageSize));
      currentPage = totalPages;
      renderPage();
    });

    function jumpToPage() {
      const totalPages = Math.max(1, Math.ceil(filteredRows.length / pageSize));
      const value = Number(pageInput.value);
      if (!Number.isFinite(value)) return;
      if (value < 1 || value > totalPages) {
        alert(`é¡µç è¶…å‡ºèŒƒå›´ï¼Œè¯·è¾“å…¥ 1 åˆ° ${totalPages}ã€‚`);
        pageInput.value = String(currentPage);
        return;
      }
      currentPage = value;
      renderPage();
    }

    pageInput.addEventListener("keydown", (event) => {
      if (event.key === "Enter") {
        jumpToPage();
      }
    });

    pageInput.addEventListener("blur", () => {
      jumpToPage();
    });

    renderList();
  </script>
</body>
</html>
